𝐃𝐚𝐲 𝟏: 𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧-𝟐 𝐨𝐟 #100DaysOfSQL 𝐁𝐲 Ankit Bansal

𝐐𝐮𝐞𝐬𝐭𝐢𝐨𝐧: 𝐘𝐨𝐮 𝐡𝐚𝐯𝐞 𝐚𝐜𝐜𝐞𝐬𝐬 𝐭𝐨 𝐝𝐚𝐭𝐚 𝐟𝐫𝐨𝐦 𝐚𝐧 𝐞𝐥𝐞𝐜𝐭𝐫𝐢𝐜𝐢𝐭𝐲 𝐛𝐢𝐥𝐥𝐢𝐧𝐠 𝐬𝐲𝐬𝐭𝐞𝐦, 𝐝𝐞𝐭𝐚𝐢𝐥𝐢𝐧𝐠 𝐭𝐡𝐞 𝐞𝐥𝐞𝐜𝐭𝐫𝐢𝐜𝐢𝐭𝐲 𝐮𝐬𝐚𝐠𝐞 𝐚𝐧𝐝 𝐜𝐨𝐬𝐭 𝐟𝐨𝐫 𝐬𝐩𝐞𝐜𝐢𝐟𝐢𝐜 𝐡𝐨𝐮𝐬𝐞𝐡𝐨𝐥𝐝𝐬 𝐨𝐯𝐞𝐫 𝐛𝐢𝐥𝐥𝐢𝐧𝐠 𝐩𝐞𝐫𝐢𝐨𝐝𝐬 𝐢𝐧 𝐭𝐡𝐞 𝐲𝐞𝐚𝐫𝐬 𝟐𝟎𝟐𝟑 𝐚𝐧𝐝 𝟐𝟎𝟐𝟒. 𝐘𝐨𝐮𝐫 𝐨𝐛𝐣𝐞𝐜𝐭𝐢𝐯𝐞 𝐢𝐬 𝐭𝐨 𝐩𝐫𝐞𝐬𝐞𝐧𝐭 𝐭𝐡𝐞 𝐭𝐨𝐭𝐚𝐥 𝐞𝐥𝐞𝐜𝐭𝐫𝐢𝐜𝐢𝐭𝐲 𝐜𝐨𝐧𝐬𝐮𝐦𝐩𝐭𝐢𝐨𝐧, 𝐭𝐨𝐭𝐚𝐥 𝐜𝐨𝐬𝐭, 𝐚𝐧𝐝 𝐚𝐯𝐞𝐫𝐚𝐠𝐞 𝐦𝐨𝐧𝐭𝐡𝐥𝐲 𝐜𝐨𝐧𝐬𝐮𝐦𝐩𝐭𝐢𝐨𝐧 𝐟𝐨𝐫 𝐞𝐚𝐜𝐡 𝐡𝐨𝐮𝐬𝐞𝐡𝐨𝐥𝐝 𝐩𝐞𝐫 𝐲𝐞𝐚𝐫 𝐝𝐢𝐬𝐩𝐥𝐚𝐲 𝐭𝐡𝐞 𝐨𝐮𝐭𝐩𝐮𝐭 𝐢𝐧 𝐚𝐬𝐜𝐞𝐧𝐝𝐢𝐧𝐠 𝐨𝐫𝐝𝐞𝐫 𝐨𝐟 𝐞𝐚𝐜𝐡 𝐡𝐨𝐮𝐬𝐞𝐡𝐨𝐥𝐝 𝐈𝐃 & 𝐲𝐞𝐚𝐫 𝐨𝐟 𝐭𝐡𝐞 𝐛𝐢𝐥𝐥.

𝐃𝐢𝐟𝐟𝐢𝐜𝐮𝐥𝐭𝐲: 𝐄𝐀𝐒𝐘.

𝐀𝐬𝐤𝐞𝐝 𝐈𝐧 𝐚 𝐂𝐨𝐦𝐩𝐚𝐧𝐲: 𝐈𝐧𝐟𝐨𝐬𝐲𝐬.

-- 𝐒𝐎𝐋𝐔𝐓𝐈𝐎𝐍:

𝐒𝐄𝐋𝐄𝐂𝐓
	𝐇𝐨𝐮𝐬𝐞𝐡𝐨𝐥𝐝_𝐈𝐃,
	𝐋𝐄𝐅𝐓(𝐁𝐢𝐥𝐥𝐢𝐧𝐠_𝐏𝐞𝐫𝐢𝐨𝐝, 𝟒) 𝐀𝐒 Year_Of_Billing,
	𝐒𝐔𝐌(𝐂𝐨𝐧𝐬𝐮𝐦𝐩𝐭𝐢𝐨𝐧_𝐊𝐖𝐇) 𝐀𝐒 Total_Electricity_Consumption,
	𝐒𝐔𝐌(𝐓𝐨𝐭𝐚𝐥_𝐂𝐨𝐬𝐭) 𝐀𝐒 Tot_Cost,
	𝐀𝐕𝐆(𝐂𝐨𝐧𝐬𝐮𝐦𝐩𝐭𝐢𝐨𝐧_𝐊𝐖𝐇) 𝐀𝐒 Average_Monthly_Consumption
𝐅𝐑𝐎𝐌 Electricity_Bill
𝐆𝐑𝐎𝐔𝐏 𝐁𝐘 Household_ID, LEFT(Billing_Period, 4)
𝐎𝐑𝐃𝐄𝐑 𝐁𝐘 Household_ID, Year_Of_Billing ASC;

#SQL #SQLChallenge #DataAnalytics #DataEngineering
